{"blocks":[{"id":"B417C5CE-7676-4A7E-B06B-9770DE578428","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"73476EEC-24D8-4472-BB8E-76EAE33F0AC4","inputs":[{"id":"run_mode","value":"triggered","type":"select","structure":{}},{"id":"async","value":"no","type":"select","structure":{}},{"id":"","value":null,"type":"custom","structure":{}}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":0},{"id":"73476EEC-24D8-4472-BB8E-76EAE33F0AC4","type":"VariableBlock","disabled":false,"name":"key","displayName":"Variable - key","comment":"","childId":"365B358E-13BA-4815-AEA2-380D4BDF1C2D","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":240,"variableGuid":"17AC9267-3B54-42C5-A2CC-F7C9AC894A9D","operations":[{"id":"set_value","key":"DE0CC9AC-EFCC-4272-8D6F-39FE4BD64F4F","name":"Set value of { variable }","value":"dapif3fb488684d261c0a577af8ee6560a"}]},{"id":"365B358E-13BA-4815-AEA2-380D4BDF1C2D","type":"CallUrlBlock","disabled":false,"name":"callURL","displayName":"Call URL","comment":"Vector Search","childId":"E014A549-0569-471F-A629-769221D4A2A3","inputs":[{"id":"url","value":"https://dbc-ef0f65b0-dc4e.cloud.databricks.com/api/2.0/vector-search/indexes/clever_catalog.llm.movies_search_emb/query","type":"string","structure":[]},{"id":"method","value":"POST","type":"select","displayValue":"POST","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":"{\n\"num_results\": \"20\",\n\"columns\": [\"tconst\"],\n\"query_text\": \"{ $.Start.Prompt }\"\n}","type":"object","mode":"raw","structure":[]},{"id":"headers","value":[{"key":"Authorization","value":"Bearer {$.key}"}],"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":720},{"id":"D797B015-28C7-46F2-9E25-64DA84729795","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"","childId":null,"inputs":[{"id":"input","value":"{ trim: { $.bucket }, '|' }","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-378,"y":637},{"id":"A96EEF71-4DF5-4B09-9EAD-71C5A34FF3AB","type":"ForEachBlock","disabled":false,"name":"loop","displayName":"Loop","comment":"","childId":"D797B015-28C7-46F2-9E25-64DA84729795","inputs":[{"id":"input","value":"{ $.callURL.result.data_array }","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-358,"y":281,"loopBlockId":"B1097A31-D18F-4F9E-87F6-F3597F439A61"},{"id":"E014A549-0569-471F-A629-769221D4A2A3","type":"VariableBlock","disabled":false,"name":"bucket","displayName":"Variable - bucket","comment":"","childId":"A96EEF71-4DF5-4B09-9EAD-71C5A34FF3AB","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-350,"y":229,"variableGuid":"E491A8CE-90AC-4658-A90B-8660A0ACAD7E","operations":[{"id":"empty","key":"59B05A28-C30E-4F6F-A250-506E9B9F84B4","name":"Empty { variable }","value":null}]},{"id":"35BF649E-7E7E-4D8A-933A-DDCAB94E58B7","type":"VariableBlock","disabled":false,"name":"bucket","displayName":"Variable - bucket","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":820,"variableGuid":"E491A8CE-90AC-4658-A90B-8660A0ACAD7E","operations":[{"id":"append","key":"CCD113FC-E63B-4777-A485-47AEFBC71FA6","name":"Append to { variable }","value":"{$.loop.item[0]}|"}]},{"id":"B1097A31-D18F-4F9E-87F6-F3597F439A61","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.loop.item[1] }","operator":">=","input2":"{ $.Start.Variance }"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-390,"y":425,"childTrueId":"35BF649E-7E7E-4D8A-933A-DDCAB94E58B7","childFalseId":null}],"variables":[{"guid":"E491A8CE-90AC-4658-A90B-8660A0ACAD7E","name":"bucket","type":"string"},{"guid":"17AC9267-3B54-42C5-A2CC-F7C9AC894A9D","name":"key","type":"string"}]}